import{R as e,C as t,a as n,G as r,T as a,B as o,L as l,H as c,b as i,V as u,c as s,d as m,e as d,f,g,h as b,i as h,S as p,j as E,k as w,l as y,m as _,n as v,o as x}from"./vendor.c7cf7dad.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let S,k=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});k.decode();let C=null;function A(){return null!==C&&C.buffer===S.memory.buffer||(C=new Uint8Array(S.memory.buffer)),C}function I(e,t){return k.decode(A().subarray(e,e+t))}const R=new Array(32).fill(void 0);R.push(void 0,null,!0,!1);let W=R.length;function F(e){W===R.length&&R.push(R.length+1);const t=W;return W=R[t],R[t]=e,t}function O(e){return R[e]}function T(e){const t=O(e);return function(e){e<36||(R[e]=W,W=e)}(e),t}function B(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=B(e[0]));for(let r=1;r<t;r++)n+=", "+B(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(a){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let j=0,L=new TextEncoder("utf-8");const $="function"==typeof L.encodeInto?function(e,t){return L.encodeInto(e,t)}:function(e,t){const n=L.encode(e);return t.set(n),{read:e.length,written:n.length}};function D(e,t,n){if(void 0===n){const n=L.encode(e),r=t(n.length);return A().subarray(r,r+n.length).set(n),j=n.length,r}let r=e.length,a=t(r);const o=A();let l=0;for(;l<r;l++){const t=e.charCodeAt(l);if(t>127)break;o[a+l]=t}if(l!==r){0!==l&&(e=e.slice(l)),a=n(a,r,r=l+3*e.length);const t=A().subarray(a+l,a+r);l+=$(e,t).written}return j=l,a}let M=null;function U(){return null!==M&&M.buffer===S.memory.buffer||(M=new Int32Array(S.memory.buffer)),M}let z=null;function K(){return null!==z&&z.buffer===S.memory.buffer||(z=new Uint32Array(S.memory.buffer)),z}let N=32;function q(e){if(1==N)throw new Error("out of js stack");return R[--N]=e,N}function G(e,t,n){try{var r=function(e,t){const n=t(4*e.length);return K().set(e,n/4),j=e.length,n}(e,S.__wbindgen_malloc),a=j;S.run(r,a,q(t),q(n))}finally{R[N++]=void 0,R[N++]=void 0}}function P(e){try{const i=S.__wbindgen_add_to_stack_pointer(-16);var t=D(e,S.__wbindgen_malloc,S.__wbindgen_realloc),n=j;S.sourceCodeGen(i,t,n);var r=U()[i/4+0],a=U()[i/4+1],o=(l=r,c=a,K().subarray(l/4,l/4+c)).slice();return S.__wbindgen_free(r,4*a),o}finally{S.__wbindgen_add_to_stack_pointer(16)}var l,c}function V(e,t){try{return e.apply(this,t)}catch(n){S.__wbindgen_exn_store(F(n))}}async function H(e){void 0===e&&(e=new URL("/koala/assets/koala_wasm_bg.5933a6a1.wasm",window.location));const t={wbg:{}};t.wbg.__wbindgen_string_new=function(e,t){return F(I(e,t))},t.wbg.__wbindgen_object_drop_ref=function(e){T(e)},t.wbg.__wbg_call_346669c262382ad7=function(){return V((function(e,t,n){return F(O(e).call(O(t),O(n)))}),arguments)},t.wbg.__wbindgen_debug_string=function(e,t){var n=D(B(O(t)),S.__wbindgen_malloc,S.__wbindgen_realloc),r=j;U()[e/4+1]=r,U()[e/4+0]=n},t.wbg.__wbindgen_throw=function(e,t){throw new Error(I(e,t))},("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if("application/wasm"==e.headers.get("Content-Type"))throw n;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return S=n.exports,H.__wbindgen_wasm_module=r,S}function J(e){return e+"rem"}var X,Q;function Y(){e.useEffect((()=>{H(),$()}),[]);const v=e.useRef("\nfn main() {\n  print(fact(5))\n  print(fib(5))\n}\n\nfn fib(n) {\n  if n {\n    if (n-1) {\n      return (fib((n-1)) + fib((n-2)))\n    }\n  }\n  return 1\n}\n\n// Factorial\nfn fact(n) {\n  if n {\n    return (fact((n-1)) * n)\n  }\n  return 1\n}\n\n// WIP\n// - local & global variables\n// - logical binary operators\n// - when (expr) -> { ... } syntax\n// - arrays ?\n\n"),[x,k]=e.useState(""),C=e.useRef(new Uint32Array),[A,R]=e.useState(""),[W,F]=e.useState({output:!0,debug:!1}),O=e=>R((t=>t+e)),T=e=>R((t=>t+e)),[B,L]=e.useState(X.open),$=()=>{let e;!function t(){L((n=>n==X.open?(clearInterval(e),e=setTimeout(t,200),X.closed):(clearInterval(e),e=setTimeout(t,1e3*(5*Math.random()+2)),X.open)))}()};return e.createElement("div",{className:"dosis-font"},e.createElement(t,{paddingX:"2rem",height:`max(100vh,${J(40)})`},e.createElement(n,{borderRadius:"xl",bg:"white",maxWidth:"container.lg",padding:"2rem",shadow:"2xl"},e.createElement(r,{gap:"5",templateColumns:{md:"1fr 3fr"}},e.createElement(t,{fontSize:"5xl",fontWeight:"bold"},e.createElement(r,{gridRow:"2"},e.createElement(a,null,"Koala."),e.createElement(a,{color:"gray.500"},B))),e.createElement(r,{gap:"5",templateRows:"auto 1fr"},e.createElement(o,{paddingX:"2"},e.createElement(t,null,e.createElement(a,{fontSize:"md",textAlign:"left"},"Koala is a simple programming language that runs on a stack-based virtual machine.",e.createElement("br",null),"It was created as a proof-of-concept while studying compiler design and hardware virtualization.",e.createElement("br",null),e.createElement("br",null),"Test out the language right here in the browser!",e.createElement("br",null),"With the help of ",e.createElement(l,{href:"https://github.com/rustwasm/wasm-pack",target:"_blank"},"wasm-pack"),", we can bring our Rust ðŸ¦€ code over to WebAssembly!"))),e.createElement(t,null,e.createElement(c,null,e.createElement(i,{leftIcon:e.createElement(u,null),onClick:()=>{Z("#editor")}},"Try It Out"),e.createElement(i,{as:"a",href:"https://github.com/ndbaker1/koala",target:"_blank",leftIcon:e.createElement(s,null)},"More on Github"))))))),e.createElement(t,{id:"editor",padding:"2rem",height:`max(100vh,${J(40)})`},e.createElement(n,{borderRadius:"xl",bg:"white",maxW:"container.lg",padding:"1rem",shadow:"2xl"},e.createElement(m,null,e.createElement(d,null,e.createElement(f,null,"Write Code"),e.createElement(f,null,"Language Docs")),e.createElement(g,null,e.createElement(b,null,e.createElement(o,{paddingBottom:"1rem"},e.createElement(h,{height:J(28),language:"python",value:v.current,onChange:e=>{v.current=e||""},options:{fontFamily:'"Consolas"'}})),e.createElement(r,{gap:"5",gridTemplateColumns:"1fr auto"},e.createElement(i,{onClick:()=>{let e;try{e="parsing",k(function(e){try{const o=S.__wbindgen_add_to_stack_pointer(-16);var t=D(e,S.__wbindgen_malloc,S.__wbindgen_realloc),n=j;S.parseAst(o,t,n);var r=U()[o/4+0],a=U()[o/4+1];return I(r,a)}finally{S.__wbindgen_add_to_stack_pointer(16),S.__wbindgen_free(r,a)}}(v.current)),e="code generation",C.current=P(v.current),R(""),e="execution",G(C.current,W.output?O:()=>{},W.debug?T:()=>{}),Z("#output")}catch(t){alert("encountered error in "+e+" stage:\n"+t)}}},"Compile & Run"),e.createElement(p,{spacing:5,direction:"row"},e.createElement(E,{isChecked:W.output,onChange:e=>F({output:e.target.checked,debug:W.debug})},"Output"),e.createElement(E,{isChecked:W.debug,onChange:e=>F({output:W.output,debug:e.target.checked})},"Debug")))),e.createElement(b,null,e.createElement(o,{paddingBottom:"1rem",height:J(28)},"Docs")))))),e.createElement(t,{id:"output",padding:"2rem",height:`max(100vh,${J(40)})`},e.createElement(n,{borderRadius:"md",bg:"white",maxWidth:"container.lg",padding:"1rem",shadow:"2xl"},e.createElement(m,null,e.createElement(d,null,e.createElement(f,null,"Info"),e.createElement(f,null,"Syntax Tree"),e.createElement(f,null,"Instructions (Hex)")),e.createElement(g,null,e.createElement(b,null,e.createElement(o,{textAlign:"left",overflow:"auto",overscrollBehavior:"contain",height:J(28)},e.createElement(o,{fontSize:"md",maxWidth:"xl"},A?e.createElement(e.Fragment,null,"One of the local Koalas has generously compiled and run our code!",e.createElement("br",null),e.createElement("br",null),e.createElement(r,{gap:"2",gridTemplateColumns:"min-content auto"},e.createElement(o,{textAlign:"left",fontSize:"xl",width:"min-content"},e.createElement(a,{whiteSpace:"nowrap"},"Â  Â  Â  Â  Â  Â ðŸ’¬"),e.createElement(a,{color:"gray.500",fontSize:"2xl",whiteSpace:"nowrap"},X.open)),e.createElement(w,{value:A,readOnly:!0})),e.createElement("br",null),"This is the output of our program, but you can also view the ",e.createElement("b",null,"Syntax Tree")," generated by the Language parser, and the corresponding 32bit ",e.createElement("b",null,"Instructions")," (in hex) that are run by the Koala Virtual Machine."):e.createElement(e.Fragment,null,"Run a Program that has Output!",e.createElement(a,{color:"gray.500",fontSize:"2xl",whiteSpace:"nowrap"},X.open))))),e.createElement(b,null,e.createElement(o,{textAlign:"left",overflow:"auto",overscrollBehavior:"contain",height:J(28)},e.createElement(y,{src:JSON.parse(x||"{}"),indentWidth:2,enableClipboard:!1,displayDataTypes:!1,quotesOnKeys:!1}))),e.createElement(b,null,e.createElement(w,{overflow:"auto",overscrollBehavior:"contain",height:J(28),fontFamily:"monospace",value:C.current.reduce(((e,t)=>e.concat(["0x"+t.toString(16).padStart(8,"0").toUpperCase()])),[]).map(((e,t)=>t.toString(16).padStart(4," ").toUpperCase()+"â”‚"+e)).join("\n")})))),e.createElement(r,null,e.createElement(i,{leftIcon:e.createElement(_,null),onClick:()=>{Z("#editor")}},"Go Back and Edit")))))}function Z(e){var t;null==(t=document.querySelector(e))||t.scrollIntoView({behavior:"smooth"})}(Q=X||(X={})).open="Ê• â€¢á´¥â€¢Ê”",Q.closed="Ê• -á´¥-Ê”";class ee{constructor(e,t){this.name=e,this.colors=t}setCurrent(){Object.entries(this.colors).forEach((([e,t])=>{document.documentElement.style.setProperty("--"+e,t)}))}static refresh(){te[0].setCurrent()}}const te=[new ee("dark",{"bg-color":"#2B2D42","bg-gradient1":"#7332ba","bg-gradient2":"#573280","text-color":"#8D99AE","text-color-hover":"#D90429","button-text-color":"white","button-bg-color":"#EF233C","button-bg-color-hover":"#D90429"}),new ee("beige-purple",{"bg-color":"#EFF8E2","bg-gradient1":"#EFF8E2","bg-gradient2":"#CECFC7","text-color":"#23022E","text-color-hover":"#573280","button-text-color":"#EFF8E2","button-bg-color":"#573280","button-bg-color-hover":"#23022E"})];te[0].setCurrent(),v.render(e.createElement(e.StrictMode,null,e.createElement(x,null,e.createElement(Y,null))),document.getElementById("root"));
